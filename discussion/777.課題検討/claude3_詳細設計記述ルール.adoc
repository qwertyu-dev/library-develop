= コードヘッダーの詳細設計ガイドライン

== 目的

このガイドラインは、コードのヘッダーに詳細設計を記載する際の標準的な構成と記載事項を定義することを目的としています。これにより、コードとドキュメントの一体化を実現し、コードの理解性、再利用性、メンテナンス性の向上を図ります。

== 構成

コードのヘッダーには、以下の構成で詳細設計を記載してください。

=== モジュール／Class

==== モジュール/classの目的、実装事項

モジュールやクラスの全体的な目的や機能を説明します。また、主要な実装事項や特徴的な点についても言及してください。

==== モジュール/classの役割定義

モジュールやクラスが、システム内でどのような役割を果たすのかを明確に定義します。他のモジュールやクラスとの関係性や、責務の範囲についても説明してください。

==== メソッド一覧

モジュールやクラスが提供するメソッドの一覧を以下のリスト形式で記載します。

- preprocess_data(raw_data: pd.DataFrame) -> pd.DataFrame: 入力データの前処理を行う。
- clean_data(data: pd.DataFrame) -> pd.DataFrame: データのクリーニングを行う。
- extract_features(data: pd.DataFrame) -> pd.DataFrame: 特徴量の抽出を行う。

==== I/O定義

モジュールやクラスの入力と出力を定義します。入力パラメータや設定ファイルの形式、出力データの形式や保存先などを明記してください。

==== パラメータ定義

モジュールやクラスで使用されるパラメータを定義します。各パラメータの名前、型、デフォルト値、説明などを記載してください。

==== 基本設計書（機能設計書／技術設計書）へのリンク

詳細な設計情報が記載された外部ドキュメントへのリンクを提供してください。これにより、コードからドキュメントへの参照が容易になります。

=== メソッドなど

==== GoogleDocに準拠した記載事項

メソッドや関数の詳細な説明は、GoogleDocスタイルに準拠して記載してください。具体的には、以下の項目を含めてください。

- 概要：メソッドや関数の目的や機能の簡単な説明。
- 引数：引数の名前、型、説明。必須かオプションかも明記。
- 戻り値：戻り値の型と説明。
- 例外：発生する可能性のある例外と、その条件。
- 使用例：メソッドや関数の使用方法を示すサンプルコード。
- 注意事項：使用上の注意点や制限事項。
- 参考情報：関連するドキュメントや資料へのリンクなど。

== 留意事項

- ヘッダーの長さ：ヘッダーが長くなりすぎないように、適切な粒度で情報を記載してください。
- 設計変更への対応：設計変更時は、コードとヘッダーの両方を更新してください。
- 外部ドキュメントとの連携：外部ドキュメントとの同期を維持してください。
- レビューと更新：定期的にヘッダーの内容をレビューし、必要に応じて更新してください。

== 例

以下に、コードのヘッダーに詳細設計を記載した例を示します。

[source,python]
----
"""
モジュール名: data_processor

目的：
- 入力データの前処理
- データのクリーニングと変換
- 特徴量の抽出

役割：
- データパイプラインの一部として、原始データを機械学習モデルに適した形式に変換する。
- 他のモジュールから入力データを受け取り、前処理後のデータを次のモジュールに引き渡す。

メソッド一覧：
==== メソッド一覧

モジュールやクラスが提供するメソッドの一覧を以下のリスト形式で記載します。
- preprocess_data(raw_data: pd.DataFrame) -> pd.DataFrame: 入力データの前処理を行う
- clean_data(data: pd.DataFrame) -> pd.DataFrame: データのクリーニングを行う
- extract_features(data: pd.DataFrame) -> pd.DataFrame: 特徴量の抽出を行う

I/O定義:
- 入力: 原始データ（CSV形式）
- 出力: 前処理後のデータ（CSV形式）

パラメータ定義：
- CLEANING_THRESHOLD (float): データクリーニングの閾値。デフォルト値は0.5
- FEATURE_LIST (List[str]): 抽出する特徴量のリスト。デフォルト値は['feature1', 'feature2']

基本設計書へのリンク：
- 機能設計書：[リンク]
- 技術設計書：[リンク]
"""

def preprocess_data(raw_data: pd.DataFrame) -> pd.DataFrame:
    """
    入力データの前処理を行う。

    Args:
        raw_data (pd.DataFrame): 原始データ

    Returns:
        pd.DataFrame: 前処理後のデータ

    Raises:
        ValueError: 入力データがNULLの場合、または入力データが空の場合
        TypeError: 入力データがpd.DataFrame型でない場合

    Examples:
        >>> raw_data = pd.read_csv('raw_data.csv')
        >>> preprocessed_data = preprocess_data(raw_data)
        >>> preprocessed_data.head()
                feature1  feature2  ...
        0       0.1       0.5  ...
        1       0.2       0.6  ...
        ...

        >>> preprocess_data(None)
        ValueError: 入力データがNULLです。

        >>> preprocess_data(pd.DataFrame())
        ValueError: 入力データが空です。

        >>> preprocess_data([1, 2, 3])
        TypeError: 入力データがpd.DataFrame型ではありません。

    Notes:
        - 前処理の手順は、基本設計書を参照してください。
        - 前処理後のデータの形式は、次の処理モジュールの要件に合わせて調整してください。
    """
    # 入力データのチェック
    if raw_data is None:
        raise ValueError("入力データがNULLです。")
    if not isinstance(raw_data, pd.DataFrame):
        raise TypeError("入力データがpd.DataFrame型ではありません。")
    if raw_data.empty:
        raise ValueError("入力データが空です。")

    # 前処理の実装
    ...
----

このガイドラインに従ってコードのヘッダーに詳細設計を記載することで、開発者間で設計情報を共有し、コードの理解性と保守性を向上させることができます。