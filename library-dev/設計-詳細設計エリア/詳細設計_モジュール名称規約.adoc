= 役割ベースのモジュール設計：効果的な命名規則ガイドライン

== はじめに

本ガイドラインは、ソフトウェア開発プロジェクトにおけるモジュール設計と命名規則の効果的な実践方法を提供することを目的とする。適切なモジュール命名は、コードの可読性、保守性、そしてプロジェクト全体の構造理解を大幅に向上させる。本ガイドラインでは、役割ベースのアプローチを採用し、各モジュールの機能と責任を明確に示す命名規則を提案する。

== 基本原則

効果的なモジュール命名には、以下の基本原則を守ることが重要である：

1. *一貫性*: プロジェクト全体で統一された命名規則を使用する。
2. *明確性*: モジュールの役割や機能が名前から即座に理解できるようにする。
3. *簡潔性*: 不必要に長い名前は避け、簡潔で意味のある名前を選択する。
4. *スケーラビリティ*: プロジェクトの成長に伴い、新しいモジュールも同じ規則で命名できるようにする。

== ファイル名の構造

基本的なファイル名の構造は以下の形式に従う：

----
<固有の名称>_<役割>.py
----

- *固有の名称*: モジュールが扱う具体的なドメインや機能を表す。
- *役割*: モジュールの技術的な役割を示す識別子。

例：

- `jinji_processor.py`
- `excel_to_dataframe_mapper.py`

ファイル名には以下のルールを適用する：

* 小文字のみを使用する
* 単語の区切りにはアンダースコア(_)を使用する
* 略語は一般的に理解されるものに限り使用し、可能な限り完全な単語を使用する

== 役割の種別と識別子

以下に、主要な役割とその識別子、および簡単な説明を示す：

[options="header", cols='1,1,3']
|===
| カテゴリ         | 識別子         | 説明
| インターフェース | _interface     | システムコンポーネントの抽象的な契約を定義
| プロセッサー     | _processor     | データ処理や変換の主要ロジックを実装
| ファクトリー     | _factory       | オブジェクトの生成を管理
| バリデーター     | _validator     | データの検証ロジックを実装
| エラーハンドラー | _error_manager | エラーの管理と処理を担当
| マッパー         | _mapper        | データ構造間の変換を行う
| 設定             | _config        | システムの設定を管理
| モデル           | _model         | データ構造やビジネスロジックを定義
| テンプレート     | _template      | 再利用可能なコードの雛形を定義
| ファサード       | _facade        | 複雑なサブシステムへのシンプルなインターフェースを提供
| ユーティリティ   | _utils         | 汎用的な機能や補助的な機能を提供
| 定義保有         | _enums         | 定義内で相互に関与のある固定値集合を定義
| ヘルパー         | _helper        | 特定の機能のサポートや補助を行う
| サービス         | _service       | ビジネスロジックを実装し、他のコンポーネントから利用される
| リポジトリ       | _repository    | データの永続化と取得を抽象化
| コントローラー   | _controller    | 外部からのリクエストを受け付け、適切な処理にルーティング
|===

各役割の使用例：

* `processor_interface.py`: プロセッサーの基本インターフェースを定義
* `jinji_processor.py`: 人事関連のデータ処理を実装
* `model_factory.py`: データモデルオブジェクトの生成を管理
* `data_validator.py`: データの検証ロジックを実装
* `validation_error_manager.py`: バリデーションエラーの管理を担当
* `excel_to_dataframe_mapper.py`: Excelデータをデータフレームに変換
* `logging_utils.py`: ログ関連のユーティリティ関数を提供
* `date_helper.py`: 日付操作のヘルパー関数を提供
* `authentication_service.py`: 認証関連のビジネスロジックを実装
* `user_repository.py`: ユーザーデータの永続化と取得を担当
* `api_controller.py`: APIリクエストの受付とルーティングを行う

== 共通ライブラリとプロジェクト固有モジュールの区別

=== 共通ライブラリの命名規則
共通ライブラリのモジュールには、特定のプレフィックスを使用して識別する。本プロジェクトでは `ibr_` プレフィックスを使用している。

例：

* `ibr_enums.py`
* `ibr_dataframe_helper.py`
* `ibr_excel_reader.py`

=== プロジェクト固有モジュールとの違い
プロジェクト固有のモジュールは、前述の役割ベースの命名規則に従う。これにより、共通ライブラリとプロジェクト固有のコードを容易に区別できる。

=== 配置ガイドライン
* 共通ライブラリ: `src/lib/common_utils/` ディレクトリに配置
* package固有モジュール: packageディレクトリ構造内に配置

=== 推奨プラクティス
. 役割を明確に示す識別子を常に使用する。
. ドメイン特有の名称と技術的役割を組み合わせる。
. 一貫性を保つために、チーム内で命名規則を文書化し共有する。
. 新しいモジュールを作成する際は、既存の命名パターンを参考にする。
. コードレビューの際に命名規則の遵守を確認する。

=== 避けるべき命名パターン（アンチパターン）
. 意味不明な略語や暗号的な名前の使用
. 役割を示さない一般的すぎる名前（例：`util.py`, `helper.py`）
. 複数の役割を一つのファイルに詰め込んだ巨大なモジュール
. 命名規則の一貫性を無視した独自の命名

== まとめ

本ガイドラインで提案した役割ベースのモジュール設計と命名規則を適用することで、以下の利点が期待できる：

. コードの可読性と理解しやすさの向上
. プロジェクト構造の明確化
. 新規開発者のオンボーディング時間の短縮
. 保守性とスケーラビリティの改善

チーム全体でこれらの規則に合意し、一貫して適用することが重要である。定期的なレビューと更新を通じて、プロジェクトの進化に合わせてガイドラインを調整していくことを推奨する。

効果的なモジュール設計と命名は、長期的なプロジェクトの成功に大きく貢献する。本ガイドラインを基に、プロジェクトに最適化された命名規則を確立し、品質の高いソフトウェア開発を実現することが望ましい。