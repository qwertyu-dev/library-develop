= 部店カナ名称設定対応 機能設計書

== はじめに

本書は、部店カナ名称設定運営定義に関する機能設計書である。現状の課題を分析し、新たな対応方針を定義することで、データの正確性と一貫性を向上させることを目的とする。

== 現状の課題と対応方針

=== 現状の課題

==== 自動生成の精度問題

部店カナ名称の自動生成機能において、以下の問題が発生している。

. 個別ルールの複雑性: 部店カナ名称の生成には多数の個別ルールが存在し、これらを完全に網羅した自動生成ロジックの実装が困難である
. 例外処理の限界: 特殊な名称や新しい命名規則に対応できず、誤った名称が生成される場合がある
. 精度の不足: 現状のシステムでは、100%の精度で正確な部店カナ名称を生成することができていない

==== データの一貫性の欠如

基準となるリファレンスデータ.部店カナ名称に関して、以下の問題が存在する。

. 人的要因による揺らぎ: これまで人の判断で入力されてきたため、データにばらつきがある
. ルールの不徹底: 想定されるルールに厳密に従っていないケースが散見される
. 過去データとの不整合: 新しく生成されるデータと過去のデータとの間に一貫性がない場合がある

==== 運用上の課題

現行の運用プロセスにおいて、以下の課題が生じている。

. エラー修正の煩雑さ: 誤って生成された名称の修正プロセスが複雑で時間を要する
. データ品質管理の困難さ: 一貫したルールをベースとしたデータ品質を維持するための仕組みが不十分である

=== 対応方針

現状の課題と現実的な解消策として、以下の対応方針を定める。

[cols="1,3,4", options="header"]
|===
|No. |対応方針 |内容
|1 |システム部門による部店カナ入力 |ユーザからの申請を受け、システム部門が部店カナ名称を入力する
|2 |ルール定義とチェックリストの導入 |部店カナ入力のルールを明確化し、チェックリストを用いた確認プロセスを導入する
|3 |人事部によるフィードバック確認 |入力された部店カナ名称を人事部が確認し、適切性をフィードバックする
|4 |一括申請レイアウトの変更 |一括申請のレイアウトに部店カナカラムを追加し、マッピング対象とする
|5 |受付処理の拡張 |受付処理において、部店カナの値の有無に応じた処理を実装する
|===

=== 役割分担

新しいプロセスにおける各関係者の役割を以下に定義する。

=== 役割分担

新しいプロセスにおける各関係者の役割を以下に定義する。

[cols="1,2", options="header"]
|===
|役割 |詳細

|ユーザ（申請者）
a|
- 部店情報の変更申請を行う
- システム部門からの問い合わせに対応する

|システム部門
a|
- ユーザからの申請を受け、部店カナ名称を入力する
- 定義されたルールとチェックリストに基づき、入力内容を確認する
- 必要に応じて、ユーザへの問い合わせを行う

|人事部
a|
- システム部門が入力した部店カナ名称の適切性を確認する
- 必要に応じて、修正依頼やフィードバックを行う

|手作業で行う業務
a|
- システム部門による部店カナ名称の入力
- チェックリストに基づく確認作業
- 人事部による適切性の確認
- フィードバックに基づく修正作業

|システム処理（一括申請と受付）
a|
- 一括申請：部店カナカラムを含む新レイアウトでのデータ取り込み
- 受付：部店カナの値の有無に応じた処理（値がある場合はそのまま出力、ない場合はリファレンステーブルから取得）
|===

== 詳細機能設計

=== 部店カナ入力機能（システム部門用）

==== データ保存プロセス
[plantuml]
....
@startuml
start
:入力画面表示;
:データ入力;
if (入力チェック) then (OK)
  :データ保存;
else (NG)
  goto データ入力;
endif
stop
@enduml
....

==== 入力ルールとチェックリスト

部店カナ名称の入力ルールとチェックリストを以下のように定義する。

[cols="1,2,2", options="header"]
|===
|No. |ルール |チェック項目
|1 |カタカナのみ使用可能 |全ての文字がカタカナであることを確認
|2 |長音記号の使用制限 |長音記号が適切に使用されているか確認
|3 |スペースの使用ルール |スペースの位置と数が適切か確認
|4 |文字数制限 |定められた文字数内であることを確認
|5 |特殊文字の使用禁止 |特殊文字が含まれていないことを確認
|===

==== 実施・再鑑プロセス

[plantuml]
....
@startuml
start
:一次入力;
:一次確認;
if (修正必要?) then (はい)
  goto 一次入力;
else (いいえ)
  :二次確認;
  if (修正必要?) then (はい)
    goto 一次入力;
  else (いいえ)
    :完了;
  endif
endif
stop
@enduml
....

=== 人事部フィードバック機能

==== フィードバック画面設計

以下の項目を含むフィードバック画面を設計する。

- 部店コード（表示のみ）
- 部店名称（表示のみ）
- 部店カナ名称（表示のみ）
- 承認状態（選択：承認/差し戻し）
- コメント（任意入力）

==== 承認プロセス

[plantuml]
....
@startuml
start
:フィードバック画面表示;
:確認作業;
if (承認?) then (はい)
  :承認登録;
else (いいえ)
  :差し戻し登録;
endif
stop
@enduml
....

=== 一括申請処理

==== 新レイアウト仕様

一括申請の新レイアウトに以下のカラムを追加する。

[cols="1,1,2", options="header"]
|===
|カラム名 |データ型 |説明
|部店カナ |文字列(50) |部店のカナ表記
|===

==== 部店カナカラムのマッピング

一括申請処理において、新たに追加した部店カナカラムを以下のようにマッピングする。

1. 入力ファイルの部店カナカラムの値を読み取る
2. 読み取った値を変更情報テーブルの対応するカラムにマッピングする
3. マッピングされたデータは、後続の受付処理に渡される

=== 受付処理

==== 部店カナ処理フロー

[plantuml]
....
@startuml
start
if (部店カナ値あり?) then (はい)
  :そのまま出力;
else (いいえ)
  :リファレンステーブル参照;
  :部店コードで検索;
  :部店カナ取得;
  :そのまま出力;
endif
stop
@enduml
....

==== リファレンステーブル参照ロジック

1. 変更情報テーブルから部店コードを取得
2. 取得した部店コードでリファレンステーブルを検索
3. 該当する部店カナ名称を取得
4. 取得した部店カナ名称を変更情報テーブルに設定

=== データフロー

==== 申請から承認までのデータフロー

[plantuml]
....
@startuml
start
:ユーザ申請;
:システム部門入力;
:チェックリスト確認;
:人事部確認;
if (承認?) then (はい)
  :データ確定;
else (いいえ)
  goto システム部門入力;
endif
stop
@enduml
....

==== システム間のデータ連携

[plantuml]
....
@startuml
一括申請 -> 受付処理
受付処理 -> 変更情報テーブル
変更情報テーブル -> リファレンステーブル
リファレンステーブル -> 後続システム
@enduml
....

== 付録

=== 用語集

[cols="1,2", options="header"]
|===
|用語 |説明
|部店カナ |銀行の部店名称のカタカナ表記
|リファレンステーブル |部店情報のマスタデータを格納するテーブル
|一括申請 |複数の部店情報変更を一度に申請する処理
|受付処理 |申請された情報を受け付け、必要な処理を行うシステム機能
|===

=== 改訂履歴

[cols="1,1,2,1", options="header"]
|===
|版数 |日付 |改訂内容 |担当者
|1.0 |2024/09/02 |初版作成 |システム設計部
|===